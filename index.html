<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Таблица</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      background-color: aliceblue;
    }

    table {
      /* border-width: 4px;
      border-style: solid;
      border-color: black;
      border-radius: 15px; */
    }

    td, th {
      font-size: 10px; 
      padding: 2px;
      text-align: center; 
      width: 100px;
      border: 1px solid black; 
      border-radius: 15px;
      height: 25px;
      vertical-align: middle; 
    }
    
    td {
      background-color: greenyellow;
    }
    
    .occupied {
      background-color: red;
    }

    #book-btn {
      display: block;
      margin: 20px auto 0;
      
      padding: 10px 15px;
      border: none;
      
      color:black; 
      background: yellow;
      
      border-radius: 15px;
      cursor: pointer;
    }

    #book-btn:active {
      background: greenyellow;
      color:black; 
  }
  </style>
  
</head>
<body>

  <table> 
    <tr>
      <th style=width: 250px>Время/Дорожки</th>
      <th>1</th>
      <th>2</th>  
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>  
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:00 - 10:30</td>
      <td id="1-10_00-10_30"></td>  
      <td id="2-10_00-10_30"></td>
      <td id="3-10_00-10_30"></td>
      <td id="4-10_00-10_30"></td>
      <td id="5-10_00-10_30"></td>
      <td id="6-10_00-10_30"></td>
      <td id="7-10_00-10_30"></td>
      <td id="8-10_00-10_30"></td>
      <td id="9-10_00-10_30"></td>
      <td id="10-10_00-10_30"></td>
      <td id="11-10_00-10_30"></td>
      <td id="12-10_00-10_30"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">11:00 - 11:30</td>
      <td id="1-11_00-11_30"></td>  
      <td id="2-11_00-11_30"></td>
      <td id="3-11_00-11_30"></td>
      <td id="4-11_00-11_30"></td>
      <td id="5-11_00-11_30"></td>
      <td id="6-11_00-11_30"></td>
      <td id="7-11_00-11_30"></td>
      <td id="8-11_00-11_30"></td>
      <td id="9-11_00-11_30"></td>
      <td id="10-11_00-11_30"></td>
      <td id="11-11_00-11_30"></td>
      <td id="12-11_00-11_30"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">11:30 - 12:00</td>
      <td id="1-11_30-12_00"></td>  
      <td id="2-11_30-12_00"></td>
      <td id="3-11_30-12_00"></td>
      <td id="4-11_30-12_00"></td>
      <td id="5-11_30-12_00"></td>
      <td id="6-11_30-12_00"></td>
      <td id="7-11_30-12_00"></td>
      <td id="8-11_30-12_00"></td>
      <td id="9-11_30-12_00"></td>
      <td id="10-11_30-12_00"></td>
      <td id="11-11_30-12_00"></td>
      <td id="12-11_30-12_00"></td>
    </tr> 
    <tr>
      <td class="occupied" style="background-color: aliceblue;">12:00 - 12:30</td>
      <td id="1-12_00-12_30"></td>  
      <td id="2-12_00-12_30"></td>
      <td id="3-12_00-12_30"></td>
      <td id="4-12_00-12_30"></td>
      <td id="5-12_00-12_30"></td>
      <td id="6-12_00-12_30"></td>
      <td id="7-12_00-12_30"></td>
      <td id="8-12_00-12_30"></td>
      <td id="9-12_00-12_30"></td>
      <td id="10-12_00-12_30"></td>
      <td id="11-12_00-12_30"></td>
      <td id="12-12_00-12_30"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">12:30 - 13:00</td>
      <td id="1-12_30-13_00"></td>  
      <td id="2-12_30-13_00"></td>
      <td id="3-12_30-13_00"></td>
      <td id="4-12_30-13_00"></td>
      <td id="5-12_30-13_00"></td>
      <td id="6-12_30-13_00"></td>
      <td id="7-12_30-13_00"></td>
      <td id="8-12_30-13_00"></td>
      <td id="9-12_30-13_00"></td>
      <td id="10-12_30-13_00"></td>
      <td id="11-12_30-13_00"></td>
      <td id="12-12_30-13_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">13:00 - 13:30</td>
      <td id="1-13_00-13_30"></td>  
      <td id="2-13_00-13_30"></td>
      <td id="3-13_00-13_30"></td>
      <td id="4-13_00-13_30"></td>
      <td id="5-13_00-13_30"></td>
      <td id="6-13_00-13_30"></td>
      <td id="7-13_00-13_30"></td>
      <td id="8-13_00-13_30"></td>
      <td id="9-13_00-13_30"></td>
      <td id="10-13_00-13_30"></td>
      <td id="11-13_00-13_30"></td>
      <td id="12-13_00-13_30"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">13:30 - 14:00</td>
      <td id="1-13_30-14_00"></td>  
      <td id="2-13_30-14_00"></td>
      <td id="3-13_30-14_00"></td>
      <td id="4-13_30-14_00"></td>
      <td id="5-13_30-14_00"></td>
      <td id="6-13_30-14_00"></td>
      <td id="7-13_30-14_00"></td>
      <td id="8-13_30-14_00"></td>
      <td id="9-13_30-14_00"></td>
      <td id="10-13_30-14_00"></td>
      <td id="11-13_30-14_00"></td>
      <td id="12-13_30-14_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>
    <tr>
      <td class="occupied" style="background-color: aliceblue;">10:30 - 11:00</td>
      <td id="1-10_30-11_00"></td>  
      <td id="2-10_30-11_00"></td>
      <td id="3-10_30-11_00"></td>
      <td id="4-10_30-11_00"></td>
      <td id="5-10_30-11_00"></td>
      <td id="6-10_30-11_00"></td>
      <td id="7-10_30-11_00"></td>
      <td id="8-10_30-11_00"></td>
      <td id="9-10_30-11_00"></td>
      <td id="10-10_30-11_00"></td>
      <td id="11-10_30-11_00"></td>
      <td id="12-10_30-11_00"></td>
    </tr>  
  </table>
  
  <div id="selected-cell">Ваш выбор: </div>
  
  
  <button id="book-btn">Забронировать</button>
  
  <script>
    var paramsString = document.location.search;  
    var searchParams = new URLSearchParams(paramsString);
    console.log('data: ', searchParams.get("data"));

    let data = JSON.parse(searchParams.get("data"));

    //  
    let cells = document.querySelectorAll('td:not(.occupied)');
    cells.forEach((cell, index) => {

      //   
      if(data[index] == 0) {
        cell.innerHTML = '';  
      } else {
        cell.innerHTML = 'X'; 
        cell.classList.add('occupied');
      }

    });

    let tg = window.Telegram.WebApp; //получаем объект webapp телеграма 
    tg.expand(); //расширяем на все окно  

    window.onload = function() {
        let bookBtn = document.getElementById('book-btn');
        // bookBtn.onclick = highlightSelectedCells;  
        
        bookBtn.addEventListener("click", () => {
            tg.sendData(JSON.stringify(cellIds));
            console.log('tg.sendData: ', JSON.stringify(cellIds));
            tg.close();
        });  

        let cells = document.querySelectorAll('td:not(.occupied)');
        let selectedCells = [];
        let cellIds = [];
        
        // ВЫВОД ячеек
        let selectedCellDiv = document.createElement('div');
        selectedCellDiv.id = 'selected-cells';
        document.body.append(selectedCellDiv);

        for(let cell of cells) {
            cell.addEventListener('click', function() {
                let cellId = this.id; 

                if(this.style.backgroundColor == '') {
                    console.log('Before select: ', selectedCells);
                    this.style.backgroundColor = 'blue';
                    selectedCells.push(cellId);
                    console.log('After select: ', selectedCells);
                } else {
                    console.log('Before deselect: ', selectedCells);
                    this.style.backgroundColor = '';
                    selectedCells = selectedCells.filter(id => id !== cellId);  
                    console.log('After deselect: ', selectedCells);
                }

                updateSelectedCells();
            });
        }

        function updateSelectedCells() {
            console.log('Update cells called'); 
            cellIds = selectedCells;
            selectedCellDiv.innerHTML = cellIds;
        }
    }
</script>


</body>
</html>